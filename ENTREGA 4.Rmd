---
title: "Entrega 4: Determinantes del desempleo juvenil en el mundo"
author: "Joel B. Huamani y Fabian Rios"
date: "2022-2"
subtitle: 'Curso: POL304 - Estadística para el análisis político 2'
output:
  prettydoc::html_pretty:
    theme: cayman
    highlight: github
---

Este breve reporte tiene como objetivo un análisis de correlación entre el desempleo juvenil (de jóvenes de 16 a 24 años) con las variables de la infraestructura de carreteras, la obesidad en adultos, la inversión extranjera, los gastos en educación pública y el PBI de 160 países del mundo en el año 2018. 
Esto se realizará por medio de la creación de modelos de regresión para advertir cuales de las variables presentadas tienen un impacto sobre la variable dependiente (Desempleo juvenil). 
+ Todo ello con el objetivo de entender en mayor profundidad algunos determinantes que podrían explicar el desempleo juvenil en el mundo. 

A continuación, se llevarán a cabo los siguientes análisis:

- Realizar un análisis descriptivo de los resultados a nivel mundial

- Implementar técnicas multivariadas para modelar el comportamiento del desempleojuvenil, particularmente de 18 a 24 años en el mundo

- Aplicar técnicas de diagnósticos de regresión.

```{r include=FALSE}
#Librerías del ejercicio:
# include = FALSE para que no salga en el html.
library(rio)
library(dplyr)
library(ggplot2)
library(cowplot)
library(kableExtra)
library(reshape)
library(DT)
library(equatiomatic)
library(modelsummary)
library(factoextra)
library(cluster)
library(lmtest)
library(nortest)
```

```{r include=FALSE}
library(rio)
data="https://github.com/taiyonoJoel/LIMPIEZA/raw/main/dataunificada.csv"

data=import(data)
```

```{r include=FALSE}
data(desempleojuv, filter = "PBI")
```

```{r include=FALSE}
data$inverex <- as.numeric(data$inverex)
data$PBI      <- as.numeric(data$PBI)
data$desempleojuv          <- as.numeric(data$desempleojuv)
```

```{r include=FALSE}
data$transito      <- as.numeric(data$transito)
data$obeadult<- as.numeric(data$obeadult)
data$gastoseduc<- as.numeric(data$gastoseduc)
```

```{r include=FALSE}
names(data)
str(data)
```

# Regresión Lineal Múltiple
```{r include=FALSE}
modelo1 = lm(desempleojuv ~ inverex + PBI, data=data)
summary(modelo1)
```

```{r include=FALSE}
modelo2 = lm(desempleojuv ~ inverex + PBI  +  transito +  obeadult + gastoseduc, data=data)
summary(modelo2)
```

Manteniendo todas las variables fijas...
(hipótesis)	
H0: No todos o ninguno de los indicadores presentan una significancia y no tienen un efecto relevante para explicar a la variable dependiente dentro de los modelos realizados
H1: Todos los indicadores muestran ser significativos y tienen un efecto relevante dentro de los modelos realizados.

+ Una vez revisamos los p-valores de cada modelo podemos observar que ambos modelos funcionan correctamente, lo que nos permite revisar cada modelo para confirmar que la hipotesis nula se ve rechazada. 

+ Observando ambos modelos, sin embargo, vemos que ûnicamente una de las variables se destaca como significante, en este caso, es la variable del crecimiento del PBI como se puede ver en el modelo 1 y 2. Este último se concentra en esa variable independiente. Entonces, con la hipótesis nula presente, tomamos en cuenta que tanto explican ambos modelos, 0.07087 y 0.06999, respectivamente. Estos valores son el porcentaje explicativo de cada modelo y vemos que hay una diferencia ínfima cuando vemos el cambio del primer modelo con el segundo: la adición de las demás variables: obesidad, gasto en educación y la infraestructura del tránsito no poseen un efecto significante en el desempleo juvenil a nivel mundial. 

+ Con estas conclusiones preliminares, vemos que los factores que toman en consideración Veronica Espinoza, para su revisión de la obesidad, como una barrera para el desempleo no se pueden aplicar en un marco a nivel global en comparación a los utilizados en Ecuador (a nivel nacional), de la misma manera ocurre en el Perú con Cesar Calvo y su postura con respecto a los gastos en educación y el ingreso recibido; los autores que realizaron sus investigaciones no es que no sean correctos, pero sus modelos de estudio no se pueden aplicar correctamente a nivel global.
  
```{r echo=FALSE}
equatiomatic::extract_eq(modelo2, use_coefs = TRUE)
```

```{r echo=FALSE}
model=list('desempleojuv'=data)

modelsummary(modelo2, title = "OLS",
             stars = TRUE,
             output = "kableExtra")
```

### Diagnósticos de regresión:

#### Linealidad:

```{r echo=FALSE}
plot(modelo2, 1)
```

Vemos que la distribución de los casos no sigue completamente la línea horizontal. Este modelo no tiene mucha linealidad, lo cual significa que este modelo no sería muy útil para hacer predicciones en otros casos.

#### Homocedasticidad:

```{r echo=FALSE}
plot(modelo2, 3)
```

```{r echo=FALSE}
bptest(modelo2)
```

El P-value es mayor a 0.05, por lo que se mantiene la hipótesis nula. Si hay homocedasticidad. El error del modelo no afecta su varianza.

#### Normalidad de los residuos:

```{r echo=FALSE}
plot(modelo2, 2)
```

```{r echo=FALSE}
shapiro.test(modelo2$residuals)
```

El P-value es menor a 0.05, por lo cual se rechaza la hipótesis nula. Los residuos del modelo no tiene una distribución normal.

#### No multicolinealidad:

Debido a que el modelo2 tiene solo una variable independiente, no esposible realizar una prueba de no multicolinealidad.

#### Valores influyentes:

```{r echo=FALSE}
plot(modelo2, 5)
```

Advertimos observaciones que están fuera de la línea de Cook, a saber, hay necesidad de eliminar algunos casos, ya que son problemáticos para el modelo2, a excepcion del PBI.

```{r echo=FALSE}
checkModelo2=as.data.frame(influence.measures(modelo2)$is.inf)
head(checkModelo2)
```

```{r echo=FALSE}
checkModelo2[checkModelo2$cook.d & checkModelo2$hat,]
```

Con las pruebas extras al modelo, podemos estar seguros de que hay casos que deberían eliminarse por su efecto en el modelo2. 
  